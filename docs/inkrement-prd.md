# Inkrement（日进）产品需求文档

> **智能语文英文每日训练应用** · PRD v1.2  
> 目标用户：上海市预初六年级在读学生（约12岁）  
> 产品定位：通过每日一项专项训练，系统提升中文写作、古文阅读、英文写作、英文阅读四项能力

---

## 版本记录

| 版本 | 日期 | 变更说明 |
|------|------|----------|
| v1.0 | 初稿 | 初版需求文档 |
| v1.1 | 更新 | 新增古文教材来源、AI多模型切换、拍照上传、重新提交、错题记录复推、技术架构方案 |
| v1.2 | 更新 | 确认所有待定问题；新增古文篇目库建设方案、短信服务选型、后台管理 UI 需求；技术选型待开发前另行确认 |

---

## 目录

1. [项目概述](#一项目概述)
2. [用户角色](#二用户角色)
3. [核心功能模块总览](#三核心功能模块总览)
4. [每日训练计划安排](#四每日训练计划安排)
5. [各模块详细需求](#五各模块详细需求)
6. [错题系统详细设计](#六错题系统详细设计)
7. [AI 模型管理](#七ai-模型管理)
8. [输入方式设计](#八输入方式设计)
9. [AI 批改通用规范](#九ai-批改通用规范)
10. [打卡与记录功能](#十打卡与记录功能)
11. [后台管理 UI](#十一后台管理-ui)
12. [技术架构](#十二技术架构)
13. [账号与认证](#十三账号与认证)
14. [非功能性需求](#十四非功能性需求)
15. [开发优先级 MVP](#十五开发优先级-mvp)
16. [待确认问题](#十六待确认问题)

---

## 一、项目概述

| 字段 | 内容 |
|------|------|
| 项目名称 | Inkrement（日进）每日训练小助手 |
| 目标用户 | 上海市预初六年级在读学生（约 12 岁） |
| 核心目标 | 通过每日一项专项训练，系统提升中文写作、古文阅读、英文写作、英文阅读四项能力 |
| 产品形态 | 网页应用（Web App），移动端浏览器优先，后续可扩展为微信小程序 |
| 技术方向 | 自主开发，前后端分离；AI 模型使用国内主流模型（Qwen 等），支持切换 |
| 文档版本 | v1.2 |

---

## 二、用户角色

### 2.1 学生端（主用户）

- 上海市预初六年级在读，年龄约 12 岁
- 每日完成系统安排的一项训练任务，支持文字输入或拍照上传（写作类）
- 可修改答案后重新提交，AI 重新批改，支持多次修改
- 可查看自己的历史训练记录、AI 批改反馈、错题本

### 2.2 家长端（监督用户）

- 查看孩子完整训练记录与每次得分
- 查看打卡日历（是否按时完成）
- 查看 AI 批改详情，了解孩子薄弱项
- 一期不支持修改训练计划

---

## 三、核心功能模块总览

| 模块 | 训练频率 | 内容形式 | AI 批改方式 |
|------|----------|----------|-------------|
| 中文写作 | 每周 2 次（周一/周四） | 随机出题 → 文字输入或拍照上传 → AI 批改 | 评分 + 详细点评 + 修改建议 + 错题标记 |
| 古文阅读 | 每周 2 次（周二/周六） | 教材篇目选段 → 阅读理解题 → 文字作答 | 逐题批改 + 解析 + 错题记录，可重复推送 |
| 英文写作 | 每周 1 次（周三） | 随机出题 → 文字输入或拍照上传 → AI 批改 | 评分 + 语法点评 + 表达建议 + 错题标记 |
| 英文阅读 | 每周 1 次（周五） | AI 生成文章 + 理解题目 → 文字作答 | 逐题批改 + 原文依据 + 词汇讲解 + 错题记录 |

---

## 四、每日训练计划安排

系统按固定周计划自动推送每日任务。含错题复推时，系统优先推送当日计划，错题作为附加项出现在当日任务末尾。

| 星期 | 训练模块 | 流程说明 |
|------|----------|----------|
| 周一 | 中文写作 | 随机出题 → 学生写作（文字/拍照）→ AI 批改 → 错题记录 |
| 周二 | 古文阅读 | 教材篇目选段 → 阅读理解题 → AI 批改 → 错题记录 |
| 周三 | 英文写作 | 随机出题 → 学生写作（文字/拍照）→ AI 批改 → 错题记录 |
| 周四 | 中文写作 | 可能含复推错题 → 学生写作 → AI 批改 |
| 周五 | 英文阅读 | AI 生成文章 + 理解题 → 作答 → AI 批改 → 错题记录 |
| 周六 | 古文阅读 / 错题复练 | 可能含复推错题 → 作答 → AI 批改 |
| 周日 | 休息 / 自由模式 | 可选择任意模块自由练习，成绩也纳入记录 |

---

## 五、各模块详细需求

### 5.1 中文写作模块

#### 题目生成

- 由 AI 随机生成符合预初/初一水平的写作题目，短期内不重复
- 题型：记叙文、描写文、读后感、简单议论文
- 字数要求：300–500 字，界面显示实时字数统计

#### 输入方式

- **方式一：文字直接输入**（默认）
- **方式二：拍照上传** — 学生拍摄手写作文，系统通过 AI 视觉能力识别文字后交给批改模型

#### 重新提交机制

- 学生可随时修改内容，点击「重新提交」后 AI 重新批改
- 每次提交均保存记录（含时间戳），学生可查看历次修改与对应批改结果
- 同一题目的最新一次提交成绩作为该次训练的最终得分

#### AI 批改维度

- 总评分（满分 100）+ 等级（A / B / C / D）
- 分项评分：内容与立意 / 结构与逻辑 / 语言表达 / 字词运用
- 详细点评：每维度不少于 2 句具体评价
- 修改建议：至少 3 条可操作建议
- 示范改写：针对 1–2 个典型问题给出改写示例

#### 错题记录

- 分项评分中任一项低于 60 分 → 标记为「薄弱项」，纳入错题本
- 系统在后续同类训练日附加 1 道错题复练

---

### 5.2 古文阅读模块

#### 内容来源

- 无现成数据源，通过网络公开资源人工整理录入，建立本地篇目库
- 目标收录篇目数：预初至初三共 **50–80 篇**，覆盖沪教版语文教材常见古文
- 参考来源：古诗文网（gushiwen.cn）、中华语文知识库等公开网站，人工核对后录入
- 篇目库字段：id / 标题 / 作者 / 朝代 / 原文 / 参考译文 / 重点字词注释 / 难度（1–5）/ 适用年级
- 后台管理 UI 提供篇目的增删改查界面，支持逐步补充

#### 篇目录入优先级

1. **第一批（上线前必备，约 20 篇）**：预初教材核心篇目，如《论语》十二章选段、《咏雪》《陈太丘与友期》等
2. **第二批（上线后持续补充，约 30 篇）**：初一常见篇目，用于拔高训练
3. **第三批（长期维护，约 30 篇）**：初二至初三篇目，供高阶学生使用

#### 题目形式

- 展示原文段落（50–150 字选段）+ 配套题目（共 5–6 小题）
- 题型：字词解释（2–3 题）、句子翻译（1–2 题）、内容理解（1–2 题）

#### 重新提交

- 同写作模块，支持修改后重新提交，AI 重新批改

#### AI 批改 + 错题记录

- 逐题批改，标明对错，给出参考答案与详细解析
- 重点字词列表与释义展示
- 答错的题目纳入错题本，系统在下次古文阅读日附加复练
- 同一错题连续答对 2 次后自动移出错题本

---

### 5.3 英文写作模块

#### 题目生成

- AI 随机生成适合预初/初一水平的英文写作题目，短期内不重复
- 题型：看图写话（文字描述图片场景）、话题作文、书信/邮件
- 字数：80–150 词，界面显示实时词数统计

#### 输入方式

- 同中文写作：支持文字输入或拍照上传

#### AI 批改

- 总评分（满分 100）+ 等级
- 分项评分：内容完整性 / 语法准确性 / 词汇运用 / 文章结构
- 语法错误标注：高亮原文错误 + 正确形式说明
- 表达优化建议：2–3 条更地道的英文表达方式
- AI 生成同题参考范文

#### 错题记录

- 总分低于 70 或语法准确性低于 60 → 纳入错题本，后续复推

---

### 5.4 英文阅读模块

#### 文章生成

- AI 生成贴近预初/初一水平的英文阅读材料，150–250 词
- 话题方向：校园生活、自然科学、文化故事、人物介绍等
- 词汇难度对标初一水平，适当引入中考词汇

#### 题目形式

- 5 道阅读理解题（选择题或填空题）
- 覆盖：细节理解、主旨概括、词义猜测、推断能力

#### AI 批改 + 错题记录

- 逐题批改，给出原文依据句
- 生词表：文中 5–8 个值得积累的词汇及释义
- 答错题目纳入错题本，连续答对 2 次后移出

---

## 六、错题系统详细设计

### 6.1 错题记录规则

- **写作类**（中文/英文）：分项评分任一项低于 60 分 → 记录该次训练为「需复习」
- **阅读类**（古文/英文）：答错的具体题目 → 以题为单位记入错题本
- 每条错题保存：原题内容、学生答案、正确答案、AI 解析、错误次数、最近练习时间

### 6.2 复推规则

| 规则项 | 说明 |
|--------|------|
| 复推时机 | 当日计划完成后作为附加项出现，可跳过 |
| 复推频率 | 每次训练日最多附加 2 道错题 |
| 复推优先级 | 错误次数多的优先；同等错误次数按时间升序（越久未练越优先） |
| 出库条件 | 同一错题连续答对 2 次（写作类为连续 2 次分项评分均 ≥ 70）→ 自动移出 |

### 6.3 错题本入口

- 学生主页设「错题本」快捷入口，可按模块筛选查看
- 支持手动进入专项练习（不计入当日打卡，但成绩纳入记录）

---

## 七、AI 模型管理

### 7.1 模型选型原则

- 优先使用国内主流模型，确保合规性与访问稳定性
- 支持在后台配置中切换模型，无需改代码
- 通过统一的 AI Provider 抽象层对接所有模型

### 7.2 支持模型列表（初期）

| 模型 | 提供方 | 适用场景 |
|------|--------|----------|
| Qwen-Max / Qwen-Plus | 阿里云百炼 | 默认模型，中文理解能力强，适合写作批改 |
| DeepSeek-V3 | DeepSeek | 备用模型，成本低，中英文均衡 |
| Qwen-VL（视觉） | 阿里云百炼 | 拍照上传时的 OCR / 手写识别 |
| GLM-4 | 智谱 AI | 可选备用，支持长文本 |

### 7.3 模型切换实现方式

- 后端封装统一 AI Provider 抽象层，所有模块调用统一接口
- 后台管理页面（管理员可见）提供模型配置下拉选择
- 可按模块单独配置（如：古文批改用 Qwen-Max，英文阅读用 DeepSeek）
- 配置热更新，无需重启服务

```typescript
// AI Provider 抽象层示例
interface AIProvider {
  chat(messages: Message[], options?: ChatOptions): Promise<string>;
  vision(image: Buffer, prompt: string): Promise<string>;
}

// 工厂方法，根据配置返回对应实现
function createProvider(model: ModelConfig): AIProvider { ... }
```

---

## 八、输入方式设计

### 8.1 文字输入

- 使用多行文本框，支持移动端软键盘输入
- 实时显示字数/词数统计
- 自动保存草稿（每 60 秒一次，防止意外丢失）

### 8.2 拍照上传（写作类专用）

- 仅中文写作和英文写作模块支持拍照上传
- 学生点击「拍照」按钮，调用设备摄像头或从相册选图
- 上传后系统用视觉 AI（Qwen-VL 或同等模型）识别手写/印刷文字
- 识别结果显示在文本框中供学生确认，可手动修改后再提交
- 图片文件存储在云端（Cloudflare R2），原图与识别文字均保存

### 8.3 重新提交逻辑

- 每次提交创建新的提交记录（`submission_id` + 时间戳）
- 前端展示「当前版本」与「历史版本」切换入口
- 历史版本可查看但不可再次修改

---

## 九、AI 批改通用规范

### 9.1 批改结构（写作类）

1. **第一屏**：总评分 + 等级徽章 + 一句总结评语
2. **第二屏**：分项评分 + 各项详细点评
3. **第三屏**：修改建议（3 条以上）+ 示范改写 + 参考范文（英文写作）

### 9.2 批改语气要求

- 面向 12 岁学生，语气鼓励为主
- 不使用「很差」「错误太多」等否定性措辞
- 正面引导：指出问题的同时给出明确改进方向

### 9.3 接口规范

- **请求体**：题目内容、学生答案（含年级背景）、历次提交成绩（用于比较进步）
- **响应格式**：结构化 JSON，前端统一解析渲染
- **响应超时**：写作类 ≤ 10 秒，阅读判题类 ≤ 5 秒
- **失败处理**：超时或报错时给出友好提示，支持手动重试

```typescript
// 批改结果 JSON 结构示例（写作类）
interface WritingFeedback {
  total_score: number;           // 0-100
  grade: 'A' | 'B' | 'C' | 'D';
  summary: string;               // 一句总结评语
  dimensions: {
    name: string;
    score: number;
    comment: string;
  }[];
  suggestions: string[];         // 修改建议列表
  rewrite_example: string;       // 示范改写
  reference_essay?: string;      // 参考范文（英文写作专用）
  needs_review: boolean;         // 是否纳入错题本
}
```

---

## 十、打卡与记录功能

### 10.1 学生端

- **主页**：当日任务卡片（含模块名、题目预览、完成状态）
- **打卡日历**：月视图，已完成日期绿色对勾，未完成灰色
- **历史记录**：可查看每次训练的题目、提交内容、AI 批改详情、各版本记录
- **成绩统计**：各模块历史平均分、最高分、近 5 次趋势折线图
- **错题本**：按模块筛选，显示错题内容与错误次数
- **连续打卡天数**（激励展示）

### 10.2 家长端

- **绑定方式**：学生生成 6 位邀请码，家长输入后关联
- 查看孩子近 30 天打卡日历
- 查看每次训练详情：题目 + 提交内容 + AI 批改结果 + 得分
- 查看各模块历史成绩趋势
- 查看孩子错题本（只读）

---

## 十一、后台管理 UI

> 供开发者（家长）自己使用，用于管理古文篇目库、查看系统数据、配置 AI 模型。界面简单实用即可，无需精美设计。

### 11.1 功能清单

| 模块 | 功能 | 说明 |
|------|------|------|
| 古文篇目管理 | 新增 / 编辑 / 删除篇目 | 填写标题、作者、原文、译文、注释、难度、适用年级 |
| 古文篇目管理 | 篇目列表与搜索 | 按年级、难度筛选，支持关键词搜索 |
| AI 模型配置 | 各模块模型切换 | 下拉选择每个模块使用的 AI 模型 |
| AI 模型配置 | API Key 管理 | 填写各模型的 API Key，加密存储 |
| 用户管理 | 查看用户列表 | 展示学生/家长账号，可手动重置密码 |
| 训练数据 | 查看训练统计 | 各模块完成次数、平均分等基础数据 |

### 11.2 访问方式

- 独立路由，如 `/admin`，需要管理员账号登录（与学生/家长账号分开）
- 初期直接用固定用户名密码登录，不走短信验证

---

## 十二、技术架构

> ⚠️ **技术选型待开发前另行确认**，本章节为占位说明，开发启动时补充完整。

### 12.1 数据库核心表设计

```sql
-- 用户表
users (id, phone, role: 'student'|'parent'|'admin', grade, created_at)

-- 家长孩子关联表
parent_child (parent_id, student_id, invite_code)

-- 每日任务计划表
training_plans (id, student_id, date, module_type, status, created_at)

-- 提交记录表（支持多版本）
submissions (id, plan_id, content, image_url, score, ai_feedback JSON, version, created_at)

-- 错题本表
wrong_questions (
  id, student_id, module, question_content,
  correct_answer, error_count, last_practiced_at,
  status: 'active'|'archived', consecutive_correct
)

-- 古文篇目库
classic_texts (id, title, author, dynasty, content, translation, notes, difficulty: 1-5, grade_level)

-- AI 模型配置表
ai_configs (id, module, provider, model_name, api_key_encrypted, updated_at)
```

---

## 十三、账号与认证

- 注册方式：手机号 + 短信验证码，短信服务使用**阿里云短信**（SMS）
- 验证码有效期：5 分钟，同一手机号每分钟限发 1 条
- 角色区分：注册时选择「学生」或「家长」
- 学生账号：绑定年级（预初/初一）
- 家长账号：通过 6 位邀请码关联孩子账号，支持关联多个孩子
- 产品当前**仅服务于自己孩子**（单一家庭），无需考虑高并发、多租户隔离等复杂场景
- 架构以简单可维护为首要原则，后续若开放给其他用户再做扩展
- 数据隔离：学生数据仅本人和已关联家长可见
- Token 有效期：30 天，到期自动续期

---

## 十四、非功能性需求

### 13.1 性能

- 页面首屏加载 < 2 秒（4G 网络）
- AI 批改响应 < 10 秒（写作类），< 5 秒（阅读判题类）
- 支持移动端浏览器（iOS Safari / Android Chrome）

### 13.2 设计风格

- 界面简洁，字体大，按钮大，减少误操作
- 鼓励性视觉元素：完成动效、成长值、连续打卡展示
- 颜色方案：清新蓝绿色系，适合学习场景

### 13.3 安全与合规

- 未成年人数据保护合规
- AI 生成内容安全过滤，确保输出适合 12 岁学生
- 拍照上传图片仅用于 OCR 识别，不用于其他用途

---

## 十五、开发优先级 MVP

| 功能点 | 优先级 | 说明 |
|--------|--------|------|
| 学生账号注册/登录 | P0 | MVP 核心 |
| 每日任务推送（4 模块） | P0 | MVP 核心 |
| 中文写作 + AI 批改 + 拍照上传 | P0 | MVP 核心 |
| 英文写作 + AI 批改 + 拍照上传 | P0 | MVP 核心 |
| 英文阅读 + AI 批改 | P0 | MVP 核心 |
| 古文阅读 + AI 批改 | P0 | MVP 核心 |
| 答案修改重新提交 | P0 | 允许多次修改 |
| 错题记录与复推机制 | P0 | MVP 核心 |
| 打卡日历 + 历史记录 | P1 | 体验提升 |
| 成绩统计图表 | P1 | 体验提升 |
| 家长端查看功能 | P1 | 核心需求 |
| 邀请码关联家长/孩子 | P1 | 家长端前提 |
| 后台管理 UI（篇目库 + 模型配置） | P1 | 古文阅读上线前必备 |
| 连续打卡激励 | P2 | 增强动力 |
| 错题专项练习模式 | P2 | 二期扩展 |

---

## 十六、待确认问题

### ✅ 全部已确认

- [x] **古文内容来源**：无现成数据源，通过网络公开资源（古诗文网等）人工整理录入，目标 50–80 篇
- [x] **短信服务**：使用阿里云短信（SMS），验证码 5 分钟有效
- [x] **产品规模**：当前仅服务自己孩子（单一家庭），架构以简单为主
- [x] **后台管理 UI**：需要简单的管理界面，覆盖古文篇目管理、AI 模型配置、用户管理
- [x] **AI 模型**：国内主流模型，默认 Qwen，支持后台配置切换
- [x] **输入方式**：文字输入为主，写作类支持拍照上传
- [x] **重新提交**：支持多次修改重新提交，保存历次记录，最新提交为最终成绩
- [x] **错题系统**：记录错题，按规则复推，连续答对 2 次移出

### ⏳ 开发前待确认

- [ ] **技术选型**：前端框架、后端框架、数据库、部署方案——开发启动前另行确认

---

*— 文档结束 · Inkrement PRD v1.2 —*
